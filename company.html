<script>
function getSlug() {
  const params = new URLSearchParams(window.location.search);
  return params.get("slug");
}

document.addEventListener("DOMContentLoaded", () => {
  const slug = getSlug();

  fetch("data/companies.json")
    .then(res => res.json())
    .then(companies => {
      const company = companies.find(c => c.slug === slug);

      if (!company) {
        document.body.innerHTML = "<h2>Company not found</h2>";
        return;
      }

      // Header
      document.getElementById("companyName").textContent = company.business_name;
      document.getElementById("companyHeadline").textContent = company.headline_en;

      // About
      document.getElementById("description").textContent = company.description_en;

      // Services
      const servicesBox = document.getElementById("services");
      servicesBox.innerHTML = "";
      company.services.forEach(s => {
        servicesBox.innerHTML += `<span class="tag">${s}</span>`;
      });

      // Products
      const productsBox = document.getElementById("products");
      productsBox.innerHTML = "";
      company.products.forEach(p => {
        productsBox.innerHTML += `<span class="tag">${p}</span>`;
      });

      // CTA Buttons
      const whatsappBtn = document.getElementById("whatsappBtn");
      const callBtn = document.getElementById("callBtn");

      // Kwa sasa tunatumia generic, baadaye utaongeza phone numbers kwenye JSON
      whatsappBtn.href = "https://wa.me/?text=Hello%20I%20found%20you%20from%20Solar%20Tanzania%20Directory";
      callBtn.href = "tel:+255700000000"; // unaweza kubadilisha baadaye

    })
    .catch(err => {
      console.error(err);
      document.body.innerHTML = "<h2>Error loading company data</h2>";
    });
});
</script>
