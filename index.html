<script>
document.addEventListener("DOMContentLoaded", () => {
  fetch("data/companies.json")
    .then(res => {
      if (!res.ok) throw new Error("Failed to load companies.json");
      return res.json();
    })
    .then(data => {
      console.log("Loaded data:", data);

      // hakikisha ni array
      const companies = Array.isArray(data) ? data : [data];
      renderDirectory(companies);
    })
    .catch(err => {
      console.error(err);
      document.getElementById("listings").innerHTML =
        "<p style='color:red'>Failed to load companies data.</p>";
    });
});

function renderDirectory(companies) {
  const container = document.getElementById("listings");
  container.innerHTML = "";

  companies.forEach(c => {
    const card = document.createElement("div");
    card.className = "card";
    card.style.cursor = "pointer";

    card.innerHTML = `
      <h3>${c.business_name}</h3>
      <small>${c.category} â€¢ ${c.region}</small>
      <h4>${c.headline_en}</h4>
      <p>${c.description_en}</p>
      <a class="btn" href="https://wa.me/" target="_blank">${c.cta_whatsapp_en}</a>
    `;

    container.appendChild(card);
  });
}
</script>
